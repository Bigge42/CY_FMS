
### 注意事项

1. **文件名要求**:  
   当前接口不支持上传文件名中包含中文字符或空格。请确保上传文件的文件名仅包含英文字符、数字、下划线、连字符等合法字符。

2. **错误处理**:  
   对于上传接口，若缺少必填参数（例如 `matchID` 或 `DocumentTypeID`），或上传的文件为空，将返回错误提示。

3. **文件格式转换**:  
   上传接口支持将非 PDF 文件转换为 PDF，转换失败时会返回相应错误信息。

4. **查询接口**:  
   批量查询接口要求至少提供 `matchID` 或 `documentTypeID` 中的一个参数，接口将根据传入的参数返回对应的文件ID集合。

---


### 1. **直接上传文件接口**

- **路径**:  
  `http://10.11.0.20:8088/fms/ftp/upload`

- **请求方法**:  
  `POST`

- **请求参数**:
  - **file** (必填): 上传的文件，类型为 `MultipartFile`。
  - **DocumentTypeID** (必填): 文档类型ID，类型为 `Integer`。例如：1 表示“Material Physicochemical Report”，2 表示“Certificate”等。
  - **matchID** (必填): 匹配ID，类型为 `String`，用于标识文件所属的匹配记录。
  - **PlanTrackingNumber** (选填): 计划跟踪号，类型为 `String`，用于标识计划的编号。
  - **createdBy** (必填): 创建人，类型为 `String`，记录上传该文件的用户。

- **请求示例**:
    ```bash
    curl -X POST http://10.11.0.20:8088/fms/ftp/upload \
      -F "file=@/path/to/file.pdf" \
      -F "DocumentTypeID=1" \
      -F "matchID=12345" \
      -F "createdBy=admin"
    ```

- **响应示例**:
  - **成功** (HTTP 200):
    ```json
    {
      "code": 200,
      "msg": "文件上传成功并已存储到数据库",
      "data": "MAN20250218155312030"
    }
    ```
  - **失败** (HTTP 500):
    ```json
    {
      "code": 500,
      "msg": "上传的文件为空"
    }
    ```

- **注意**:
  - **文件名要求**: 目前接口不支持上传文件名中包含中文字符或空格，请确保上传的文件名仅由英文字符、数字、下划线、连字符等合法字符组成。

- **描述**:  
  用于直接上传文件，不进行格式转换。上传后将文件存储到服务器的指定目录，并在数据库中记录相关信息（包括文件ID、文件名、匹配ID、文档类型等）。

---

### 2. **上传文件后转换为 PDF 接口**

- **路径**:  
  `http://10.11.0.20:8088/fms/ftp/uploadToPdf`

- **请求方法**:  
  `POST`

- **请求参数**:
  - **file** (必填): 上传的文件，类型为 `MultipartFile`。
  - **DocumentTypeID** (必填): 文档类型ID，类型为 `Integer`。
  - **matchID** (必填): 匹配ID，类型为 `String`。
  - **PlanTrackingNumber** (选填): 计划跟踪号，类型为 `String`。
  - **createdBy** (必填): 创建人，类型为 `String`。

- **请求示例**:
    ```bash
    curl -X POST http://10.11.0.20:8088/fms/ftp/uploadToPdf \
      -F "file=@/path/to/file.docx" \
      -F "DocumentTypeID=1" \
      -F "matchID=12345" \
      -F "createdBy=admin"
    ```

- **响应示例**:
  - **成功** (HTTP 200):
    ```json
    {
      "code": 200,
      "msg": "文件上传成功并已存储到数据库",
      "data": "MAN20250218155312031"
    }
    ```
  - **失败** (HTTP 500):
    ```json
    {
      "code": 500,
      "msg": "文件转换为 PDF 失败"
    }
    ```

- **注意**:
  - **文件名要求**: 上传文件名中不能包含中文字符或空格，请使用合法的英文文件名。

- **描述**:  
  用于上传文件并将其转换为 PDF 格式。适用于上传的原始文件为非 PDF 格式（例如 Word、Excel），系统会先保存文件至临时目录，再转换为 PDF 文件上传，并在数据库中记录转换后的文件信息。

---

### 3. **下载文件接口**

- **路径**:  
  `http://10.11.0.20:8088/fms/ftp/download`

- **请求方法**:  
  `GET`

- **请求参数**:
  - **fileId** (必填): 文件ID，类型为 `String`。通过文件ID在数据库中查找对应的文件路径。

- **请求示例**:
    ```bash
    curl -X GET "http://10.11.0.20:8088/fms/ftp/download?fileId=MAN20250218155312030"
    ```

- **响应示例**:
  - **成功**:  
    返回文件内容，用户可直接下载文件。
  - **失败** (HTTP 404):
    ```json
    {
      "code": 404,
      "msg": "文件未找到"
    }
    ```

- **描述**:  
  根据提供的 `fileId` 从服务器下载文件。如果文件不存在，则返回 404 状态码。

---

### 4. **在线预览文件接口**

- **路径**:  
  `http://10.11.0.20:8088/fms/ftp/preview`

- **请求方法**:  
  `GET`

- **请求参数**:
  - **fileId** (必填): 文件ID，类型为 `String`。用于从数据库中查找对应的文件路径。

- **请求示例**:
    ```bash
    curl -X GET "http://10.11.0.20:8088/fms/ftp/preview?fileId=MAN20250218155312030"
    ```

- **响应示例**:
  - **成功**:  
    返回文件内容，直接在浏览器中预览文件（适用于 PDF、图片等格式）。
  - **失败** (HTTP 404):
    ```json
    {
      "code": 404,
      "msg": "文件未找到"
    }
    ```

- **描述**:  
  根据 `fileId` 实现在线预览文件。适用于用户在浏览器中直接查看文件内容。

---

### 5. **根据 `matchID` 和 `documentTypeID` 查询文件ID集合接口**

- **路径**:  
  `http://10.11.0.20:8088/fms/ftp/getFileIDs`

- **请求方法**:  
  `GET`

- **请求参数**:
  - **matchID** (选填): 匹配ID，类型为 `String`。可单独用于查询文件。
  - **documentTypeID** (选填): 文档类型ID，类型为 `Integer`。可单独用于查询文件。

  **说明**: 至少必须提供其中一个参数。

- **请求示例**:
  - 仅使用 `matchID`:
    ```bash
    curl -X GET "http://10.11.0.20:8088/fms/ftp/getFileIDs?matchID=12345"
    ```
  - 仅使用 `documentTypeID`:
    ```bash
    curl -X GET "http://10.11.0.20:8088/fms/ftp/getFileIDs?documentTypeID=1"
    ```
  - 同时使用两个参数:
    ```bash
    curl -X GET "http://10.11.0.20:8088/fms/ftp/getFileIDs?matchID=12345&documentTypeID=1"
    ```

- **响应示例** (成功):
    ```json
    {
        "code": 200,
        "msg": "查询成功",
        "data": [
            {
                "documentTypeID": 2,
                "fileID": "CER20250219092459250"
            },
            {
                "documentTypeID": 2,
                "fileID": "CER20250219092506125"
            },
            {
                "documentTypeID": 3,
                "fileID": "MAN20250218152236684"
            },
            {
                "documentTypeID": 3,
                "fileID": "MAN20250218161240955"
            },
            {
                "documentTypeID": 3,
                "fileID": "MAN20250218161249896"
            },
            {
                "documentTypeID": 3,
                "fileID": "MAN20250218161319570"
            },
            {
                "documentTypeID": 3,
                "fileID": "MAN20250218163518433"
            },
            {
                "documentTypeID": 3,
                "fileID": "MAN20250218165616690"
            },
            {
                "documentTypeID": 1,
                "fileID": "MPR20250219092456665"
            }
        ]
    }
    ```

- **响应示例** (失败):
    ```json
    {
        "code": 500,
        "msg": "查询文件ID失败"
    }
    ```

- **描述**:  
  根据提供的 `matchID` 和/或 `documentTypeID` 查询文件ID集合。至少必须提供其中一个参数。如果同时提供，则返回同时匹配的结果；否则，根据单一参数进行查询。

---

以下是**批量查询接口**的详细接口文档：

---

### 6.**批量查询文件ID集合接口**

**接口描述**:  
根据传入的匹配ID (`matchID`) 与文档类型ID集合 (`documentTypeIDs`)，批量查询对应的文件ID集合。  
返回结果为数组，每个对象包含对应的 `documentTypeID` 及查询到的 `fileID`。

---

**请求路径**:  
`http://10.11.0.20:8088/fms/ftp/batchGetFileIDs`

**请求方法**:  
`GET`

**请求参数**:

| 参数名称             | 类型              | 必填 | 说明                                                        | 示例                |
|----------------------|-------------------|------|-------------------------------------------------------------|---------------------|
| `matchID`            | `String`          | 是   | 匹配ID，用于标识文件所属的匹配记录                           | `"12345"`           |
| `documentTypeIDs`    | `List<Integer>`   | 是   | 文档类型ID集合，可传入多个，用英文逗号分隔（例如：1,2,3）       | `1,2,3`             |

**请求示例**:
- 通过浏览器或 curl 请求示例：
  ```bash
  curl -X GET "http://10.11.0.20:8088/fms/ftp/batchGetFileIDs?matchID=12345&documentTypeIDs=1,2,3"
  ```

---

**响应示例**:

- **成功时** (HTTP 200):
  ```json
  {
      "code": 200,
      "msg": "操作成功",
      "data": [
          { "documentTypeID": 2, "fileID": "12212" },
          { "documentTypeID": 3, "fileID": "12213" }
      ]
  }
  ```

- **失败时** (HTTP 500):
  ```json
  {
      "code": 500,
      "msg": "批量查询文件ID失败",
      "data": "<错误信息>"
  }
  ```

---

**返回字段说明**:

- **code**: 状态码，`200` 表示成功，`500` 表示失败。
- **msg**: 操作描述信息。
- **data**: 返回的文件ID集合数据，格式为数组。  
  每个数组项为一个 JSON 对象，其中包含：
  - `documentTypeID`: 文档类型ID，对应查询条件中的一个文档类型。
  - `fileID`: 查询到的文件ID。

---

**参数校验**:
- 接口要求必须提供 `matchID`，且不能为空字符串。
- `documentTypeIDs` 集合也必须不为空，至少包含一个文档类型ID。

---

**错误提示**:
- 如果未提供 `matchID` 或 `documentTypeIDs`，接口将返回错误提示：
  ```json
  {
      "code": 500,
      "msg": "必须提供 matchID 和至少一个 documentTypeID"
  }
  ```
- 如果查询过程中发生异常，将返回 `"批量查询文件ID失败"` 及异常信息。

---

**说明**:
- 该接口通过 GET 请求接收参数，适用于批量查询文件ID集合。
- 服务器端会根据传入的 `matchID` 和 `documentTypeIDs` 调用业务层方法查询数据，并返回查询结果。
- 返回数据中，每个对象表示某一文档类型对应的一个文件ID。若某个文档类型有多个文件记录，则返回的数组中可能包含多个对象，其 `documentTypeID` 值相同但 `fileID` 不同。

---

